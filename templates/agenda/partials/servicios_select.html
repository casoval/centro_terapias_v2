<label class="block text-xs font-bold text-emerald-900 mb-1">
    üè• Servicio * <span class="text-gray-500 font-normal">(Paso 2)</span>
</label>

{% if servicios %}
<select name="servicio_id" id="servicio-select" required
        class="w-full px-2 py-1.5 border-2 border-emerald-100 rounded-lg text-xs focus:border-emerald-500">
    <option value="">Seleccione servicio...</option>
    {% for ps in servicios %}
    <option value="{{ ps.servicio.id }}" 
            data-costo="{{ ps.costo_sesion }}"
            data-precio-mensual="{{ ps.servicio.precio_mensual|default:'' }}"
            data-precio-proyecto="{{ ps.servicio.precio_proyecto|default:'' }}"
            data-duracion="{{ ps.servicio.duracion_minutos }}"
            data-nombre="{{ ps.servicio.nombre }}">
        {% if tipo_precio == 'mensualidad' %}
            {# Mostrar precio mensual #}
            {% if ps.servicio.precio_mensual %}
                {{ ps.servicio.nombre }} (Bs. {{ ps.servicio.precio_mensual }})
            {% else %}
                {{ ps.servicio.nombre }} (Sin precio mensual)
            {% endif %}
        {% elif tipo_precio == 'proyecto' %}
            {# Mostrar precio de proyecto #}
            {% if ps.servicio.precio_proyecto %}
                {{ ps.servicio.nombre }} (Bs. {{ ps.servicio.precio_proyecto }})
            {% else %}
                {{ ps.servicio.nombre }} (Sin precio proyecto)
            {% endif %}
        {% elif tipo_precio == 'recurrente' %}
            {# NO mostrar precio para sesiones recurrentes #}
            {{ ps.servicio.nombre }}
        {% else %}
            {# Default: mostrar costo por sesi√≥n #}
            {{ ps.servicio.nombre }} (Bs. {{ ps.costo_sesion }})
        {% endif %}
    </option>
    {% endfor %}
</select>
<p class="text-xs text-green-600 mt-1">‚úÖ {{ servicios|length }} servicio(s) contratado(s)</p>
{% elif error %}
<div class="mb-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-700">
    ‚ö†Ô∏è {{ error }}
</div>
<select name="servicio_id" id="servicio-select" disabled
        class="w-full px-2 py-1.5 border-2 border-gray-200 bg-gray-50 rounded-lg text-xs text-gray-400">
    <option value="">No hay servicios disponibles</option>
</select>
{% else %}
<select name="servicio_id" id="servicio-select" disabled
        class="w-full px-2 py-1.5 border-2 border-gray-200 bg-gray-50 rounded-lg text-xs text-gray-400">
    <option value="">Sin servicios contratados</option>
</select>
<p class="text-xs text-orange-600 mt-1">‚ö†Ô∏è Este paciente no tiene servicios activos</p>
{% endif %}