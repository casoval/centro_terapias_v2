{% extends 'base.html' %}

{% block title %}Eliminar Profesional - Centro Infantil Misael{% endblock %}

{% block content %}
<style>
    .btn-peligro { transition: all 0.2s ease; }
    .btn-peligro:hover { transform: scale(1.02); box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3); }
    .btn-seguro { transition: all 0.2s ease; }
    .btn-seguro:hover { transform: scale(1.02); box-shadow: 0 10px 25px rgba(251, 146, 60, 0.3); }
</style>

<div class="mb-8">
    <div class="relative bg-gradient-to-r from-red-500 via-red-600 to-red-700 rounded-3xl p-6 sm:p-8 shadow-xl overflow-hidden">
        <div class="absolute top-0 right-0 -mr-8 -mt-8 w-32 h-32 rounded-full bg-orange-400 opacity-20 blur-2xl"></div>
        <div class="absolute bottom-0 left-0 -ml-8 -mb-8 w-24 h-24 rounded-full bg-pink-500 opacity-20 blur-xl"></div>
        
        <div class="relative flex flex-col sm:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-2xl sm:text-3xl font-black text-white flex items-center gap-3">
                    <span class="bg-white/20 p-2 rounded-xl backdrop-blur-sm shadow-inner">‚ö†Ô∏è</span> 
                    Eliminar Profesional
                </h1>
                <p class="text-red-100 text-sm mt-2 font-medium">
                    {% if tiene_datos %}üîí Acci√≥n restringida por seguridad{% else %}Esta acci√≥n NO se puede deshacer{% endif %}
                </p>
            </div>
            <a href="{% url 'profesionales:lista' %}" 
               class="group bg-white/10 text-white px-6 py-2.5 rounded-full font-bold text-sm shadow-lg hover:bg-white hover:text-red-600 transition-all flex items-center gap-2 border border-white/20 backdrop-blur-md">
                <span>‚Üê</span> Cancelar
            </a>
        </div>
    </div>
</div>

<div class="max-w-3xl mx-auto">
    <div class="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden">
        
        <div class="bg-red-50 p-8 text-center border-b border-red-100">
            <div class="w-20 h-20 bg-white rounded-full flex items-center justify-center text-4xl shadow-md mx-auto mb-4 border-4 border-red-100">
                {% if tiene_datos %}üîí{% else %}üóëÔ∏è{% endif %}
            </div>
            <h2 class="text-2xl font-black text-gray-800 mb-2">
                {% if tiene_datos %}Imposible eliminar registro{% else %}¬øEst√°s seguro de eliminar?{% endif %}
            </h2>
            <p class="text-sm text-red-600 font-medium max-w-md mx-auto">
                {% if tiene_datos %}
                Este profesional tiene historial cl√≠nico asociado que no puede ser borrado.
                {% else %}
                Est√°s a punto de borrar permanentemente el siguiente perfil del sistema.
                {% endif %}
            </p>
        </div>
        
        <div class="p-8">
            <div class="bg-white rounded-2xl p-6 border border-gray-100 shadow-sm mb-6 flex flex-col sm:flex-row items-center sm:items-start gap-6">
                <div class="flex-shrink-0">
                    {% if profesional.tiene_foto %}
                        <img src="{{ profesional.get_foto_thumbnail }}" class="w-20 h-20 rounded-full object-cover border-4 border-gray-50 shadow-sm">
                    {% else %}
                        <div class="bg-emerald-50 text-emerald-300 w-20 h-20 rounded-full flex items-center justify-center text-4xl border-4 border-white shadow-sm">üë®‚Äç‚öïÔ∏è</div>
                    {% endif %}
                </div>
                
                <div class="flex-1 w-full text-center sm:text-left">
                    <h3 class="text-xl font-black text-gray-800">{{ profesional.nombre_completo }}</h3>
                    <p class="text-sm font-bold text-emerald-600 mb-2">{{ profesional.especialidad }}</p>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-left border-t border-gray-50 pt-3">
                        <div>
                            <p class="text-[10px] text-gray-400 font-bold uppercase tracking-wide">Contacto</p>
                            <p class="text-xs font-bold text-gray-700">{{ profesional.telefono|default:"--" }}</p>
                            <p class="text-xs text-gray-500">{{ profesional.email|default:"--" }}</p>
                        </div>
                        <div>
                            <p class="text-[10px] text-gray-400 font-bold uppercase tracking-wide">Usuario Sistema</p>
                            {% if profesional.user %}
                                <p class="text-xs font-black text-indigo-600">üë§ {{ profesional.user.username }}</p>
                            {% else %}
                                <p class="text-xs text-gray-400 italic">Sin asignar</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="space-y-4">
                {% if tiene_datos %}
                <div class="bg-red-50 border border-red-200 rounded-2xl p-5">
                    <div class="flex items-start gap-4">
                        <span class="text-2xl bg-white rounded-full p-1 shadow-sm">üö´</span>
                        <div class="flex-1">
                            <p class="text-sm font-black text-red-900 mb-1">ELIMINACI√ìN BLOQUEADA</p>
                            <p class="text-xs text-red-700 font-medium mb-3">Datos asociados encontrados:</p>
                            <div class="grid grid-cols-2 gap-3 mb-3">
                                {% if datos_relacionados.sesiones > 0 %}
                                <div class="bg-white/60 rounded-xl p-2 border border-red-100 text-center">
                                    <p class="text-lg font-black text-red-800">{{ datos_relacionados.sesiones }}</p>
                                    <p class="text-[9px] text-red-500 font-bold uppercase">Sesiones</p>
                                </div>
                                {% endif %}
                                {% if datos_relacionados.pacientes > 0 %}
                                <div class="bg-white/60 rounded-xl p-2 border border-red-100 text-center">
                                    <p class="text-lg font-black text-red-800">{{ datos_relacionados.pacientes }}</p>
                                    <p class="text-[9px] text-red-500 font-bold uppercase">Pacientes</p>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-orange-50 border border-orange-200 rounded-2xl p-5 shadow-sm">
                    <div class="flex items-start gap-4">
                        <span class="text-2xl bg-white rounded-full p-1 shadow-sm">‚úÖ</span>
                        <div class="flex-1">
                            <p class="text-sm font-black text-orange-900 mb-1">RECOMENDACI√ìN: Desactivar</p>
                            <p class="text-xs text-orange-800 mb-1">
                                Al desactivar, el profesional no aparecer√° en nuevas asignaciones, pero se conserva su historial.
                            </p>
                        </div>
                    </div>
                </div>

                {% else %}
                <div class="bg-yellow-50 border border-yellow-200 rounded-2xl p-4">
                    <p class="text-xs font-bold text-yellow-800 flex items-center gap-2">
                        <span>‚ö†Ô∏è</span> Consecuencias:
                    </p>
                    <ul class="mt-2 space-y-1 ml-6 list-disc text-[11px] text-yellow-800">
                        <li>Se eliminar√° el perfil del profesional.</li>
                        <li>Se desvincular√° del usuario de sistema (si tiene).</li>
                        <li>No podr√°s recuperar esta informaci√≥n.</li>
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
        
        <div class="bg-gray-50 p-6 sm:p-8 border-t border-gray-100">
            <form method="post" id="formEliminar" class="flex flex-col gap-3">
                {% csrf_token %}
                
                <button type="submit" name="accion" value="desactivar"
                        class="btn-seguro w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-4 rounded-xl font-black text-sm shadow-lg hover:shadow-xl flex items-center justify-center gap-2">
                    <span>üîí</span> DESACTIVAR PROFESIONAL (Seguro)
                </button>
                
                {% if not tiene_datos %}
                <button type="submit" name="accion" value="eliminar" onclick="return confirmarEliminacion()"
                        class="btn-peligro w-full bg-white border-2 border-red-100 text-red-600 hover:bg-red-50 py-3 rounded-xl font-bold text-xs flex items-center justify-center gap-2 mt-2">
                    <span>üóëÔ∏è</span> S√≠, eliminar permanentemente
                </button>
                {% endif %}
                
                <a href="{% url 'profesionales:lista' %}" class="text-center text-xs font-bold text-gray-400 hover:text-gray-600 mt-2">
                    Cancelar
                </a>
            </form>
        </div>
    </div>
</div>

<script>
function confirmarEliminacion() {
    return confirm('‚ö†Ô∏è ¬øEst√°s seguro de eliminar a {{ profesional.nombre_completo }}? Esta acci√≥n es irreversible.');
}
</script>
{% endblock %}